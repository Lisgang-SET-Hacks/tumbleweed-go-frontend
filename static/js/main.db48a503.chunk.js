(this["webpackJsonptumbleweed-go-frontend"]=this["webpackJsonptumbleweed-go-frontend"]||[]).push([[0],{136:function(e,t,a){e.exports=a.p+"static/media/text_white.a7cace2a.svg"},163:function(e,t,a){e.exports=a(195)},192:function(e,t,a){},193:function(e,t,a){},194:function(e,t,a){},195:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(38),i=a.n(l),o=a(139),c=a(234),u=a(233),s=a(140),d=a(49),m=a(56),p=a(52),b=a(51),w=a(111),f=a.n(w),h=a(228),g=a(197),v=a(225),y=a(141),T=a(219),E=a(243),D=a(235),L=a(142),S=a(7),_=a(130),O=a(242),I=a(236),k=a(240),x=a(239),F=a(237),j=a(114),C=a(115),R=a(112),P=a(88),N=function(e){var t=e.toDateString().split(" ");return t[0]+" "+t[2]},M=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=e<0?"S":"N",r=t<0?"W":"E";return"".concat(e.toFixed(a),"&#xb0;").concat(n,", ").concat(t.toFixed(a),"&#xb0;").concat(r)},A=(a(185),function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).initWithData=function(e){n.tumbleweedLayers=[],n.tumbleweedTrailLayers=[];for(var t=0;t<n.props.sliderRange;t++)n.tumbleweedLayers.push(n.setTumbleweedLayer(e,t-1)),n.tumbleweedTrailLayers.push(n.setTumbleweedTrailLayer(e,t-1));n.currentTumbleweedLayer=n.tumbleweedLayers[0],n.currentTumbleweedTrailLayer=n.tumbleweedTrailLayers[0],n.initMap()},n.deleteTumbleweed=function(e){var t=n.tumbleweedLayers[0],a=t.getSource().getFeatureById("tumbleweed_".concat(e));a&&t.getSource().removeFeature(a);for(var r=1;r<n.props.sliderRange;r++){var l=n.tumbleweedLayers[r],i=l.getSource().getFeatureById("tumbleweed_".concat(e,"_").concat(r-1));i&&l.getSource().removeFeature(i)}for(var o=0;o<n.props.sliderRange;o++){var c=n.tumbleweedTrailLayers[o],u=c.getSource().getFeatureById("tumbleweedTrail_".concat(e));u&&c.getSource().removeFeature(u)}},n.setTumbleweedLayer=function(e,t){var a=new j.b({image:new C.a({radius:8,fill:new R.a({color:"#e3af2b"}),stroke:new P.a({color:"#664e13",width:2})})}),n=new j.b({image:new C.a({radius:8,fill:new R.a({color:"#e2cf9e"}),stroke:new P.a({color:"#664e13",width:2})})}),r=e.map((function(e,r){var l,i,o,c=a;if(-1===t)l="tumbleweed_".concat(r),o=e.location._latitude,i=e.location._longitude;else if(0===e.predictedLocations.length)l="tumbleweed_".concat(r),o=e.location._latitude,i=e.location._longitude,c=n;else if(t<e.predictedLocations.length)l="tumbleweed_".concat(r,"_").concat(t),o=e.predictedLocations[t]._latitude,i=e.predictedLocations[t]._longitude;else{var u=e.predictedLocations.length-1;l="tumbleweed_".concat(r,"_").concat(u),o=e.predictedLocations[u]._latitude,i=e.predictedLocations[u]._longitude,c=n}var s=new T.a({geometry:new _.a(Object(S.d)([i,o]))});return s.setId(l),s.setStyle(c),s})),l=new I.a({source:new x.a({features:r})});return l.set("name","tumbleweeds"),l},n.setTumbleweedTrailLayer=function(e,t){var a=new j.b({stroke:new P.a({color:"#664e13",width:4})}),n=[];if(-1!==t)for(var r=function(t){e.forEach((function(e,r){if(t<e.predictedLocations.length){var l=0===t?e.location._latitude:e.predictedLocations[t-1]._latitude,i=0===t?e.location._longitude:e.predictedLocations[t-1]._longitude,o=e.predictedLocations[t]._latitude,c=e.predictedLocations[t]._longitude,u=new T.a({geometry:new O.a([Object(S.d)([i,l]),Object(S.d)([c,o])])});u.setId("tumbleweedTrail_".concat(r)),u.setStyle(a),n.push(u)}}))},l=0;l<=t;l++)r(l);var i=new I.a({source:new x.a({features:n})});return i.set("name","tumbleweedTrails"),i},n.initMap=function(){var e=new k.a({className:"map__bingMaps",source:new F.a({key:"AtMr0RAC0iKdKPPPsGSPqIFCxjk7XpR9rq99IQR5vDBoax8u1KuYvOinwtsiQcFI",imagerySet:"AerialWithLabelsOnDemand"})});n.popupOverlay=new E.a({element:n.popupRef.current,positioning:"bottom-center",stopEvent:!1,offset:[0,-16]}),n.map=new D.a({layers:[e,n.currentTumbleweedTrailLayer,n.currentTumbleweedLayer],overlays:[n.popupOverlay],target:n.mapRef.current,view:new L.a({center:Object(S.d)([-97,42]),zoom:5,minZoom:5,maxZoom:15})}),n.map.on("click",(function(e){n.deselectTumbleweed(),n.map.forEachFeatureAtPixel(e.pixel,(function(e,t){if("tumbleweeds"===t.get("name"))return n.selectTumbleweed(e),!0}))})),n.map.on("pointermove",(function(e){n.map.getTarget().style.cursor="",n.map.forEachFeatureAtPixel(e.pixel,(function(e,t){if("tumbleweeds"===t.get("name"))return n.map.getTarget().style.cursor="pointer",!0}))}))},n.selectTumbleweed=function(e){var t=String(e.getId()).split("_").splice(1),a=Object(y.a)(t,2),r=a[0],l=a[1];void 0!==l?n.props.updateSelectedTumbleweedDataFunc(r,l):n.props.updateSelectedTumbleweedDataFunc(r,-1),n.showPopup(e)},n.deselectTumbleweed=function(){n.props.updateSelectedTumbleweedDataFunc(-1,-1),n.hidePopup()},n.showPopup=function(e){var t=e.getGeometry().getCoordinates(),a=Object(S.n)(t,"EPSG:3857","EPSG:4326");n.popupRef.current.innerHTML=M(a[1],a[0],3),n.popupRef.current.style.display="block",n.popupOverlay.setPosition(t)},n.hidePopup=function(){n.popupRef.current.style.display="none"},n.refreshPopup=function(){if(-1!==n.props.selectedTumbleweedIndex){var e=n.currentTumbleweedLayer.getSource().getFeatures();n.showPopup(e[n.props.selectedTumbleweedIndex])}},n.showTumbleweedLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.map.removeLayer(n.currentTumbleweedTrailLayer),n.map.removeLayer(n.currentTumbleweedLayer),n.map.addLayer(n.tumbleweedTrailLayers[e]),n.map.addLayer(n.tumbleweedLayers[e]),n.currentTumbleweedLayer=n.tumbleweedLayers[e],n.currentTumbleweedTrailLayer=n.tumbleweedTrailLayers[e],t()},n.map=null,n.popupOverlay=null,n.tumbleweedLayers=null,n.tumbleweedTrailLayers=null,n.currentTumbleweedLayer=null,n.currentTumbleweedLayer=null,n.mapRef=r.a.createRef(),n.popupRef=r.a.createRef(),n}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(e,t){var a=this;e.data!==this.props.data&&this.initWithData(this.props.data),e.day!==this.props.day&&this.showTumbleweedLayer(this.props.day,(function(){a.refreshPopup()})),e.deleteTumbleweedFlag!==this.props.deleteTumbleweedFlag&&(this.deselectTumbleweed(),this.deleteTumbleweed(this.props.selectedTumbleweedIndex))}},{key:"render",value:function(){return r.a.createElement("div",{ref:this.mapRef,className:"map"},r.a.createElement("div",{ref:this.popupRef,className:"map__popup",style:{display:"none"}}))}}]),a}(r.a.Component)),B=a(222),W=a(223),G=a(224),H=a(135),K=a.n(H),q=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).render=function(){var t=e.props,a=t.data,n=t.predictionIndex;if(!a)return r.a.createElement(g.a,{component:"div",align:"center"},r.a.createElement("h4",null,"No tumbleweed selected."));var l=a.location;if(a.predictedLocations.length>0&&-1!==n){var i=Math.min(n,a.predictedLocations.length-1);l=a.predictedLocations[i]}return r.a.createElement(g.a,{component:"div",align:"center"},r.a.createElement("h4",null,"Current position (est.)"),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:M(l._latitude,l._longitude)}}),r.a.createElement(B.a,null),r.a.createElement("h4",null,"Initial sighting time"),r.a.createElement("p",null,new Date(a.uploadTime).toLocaleDateString(),r.a.createElement("br",null),new Date(a.uploadTime).toLocaleTimeString()),r.a.createElement("h4",null,"Initial sighting position"),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:M(a.uploadLocation._latitude,a.uploadLocation._longitude)}}),r.a.createElement("h4",null,"Initial sighting image"),r.a.createElement(W.a,{className:"aspect-ratio",variant:"outlined",style:{paddingBottom:"75%",marginBottom:"1em"}},r.a.createElement("div",null,r.a.createElement(G.a,{onClick:function(){return alert("test")}},r.a.createElement("img",{src:"https://picsum.photos/400",alt:"Initial sighting"})))),r.a.createElement(v.a,{startIcon:r.a.createElement(K.a,null),variant:"contained",color:"primary",disableElevation:!0,onClick:e.props.removeTumbleweedFunc},"Remove this tumbleweed"))},e}return a}(r.a.Component),J=a(241),Q=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={sliderMarks:[]},e.setSliderMarks=function(){for(var t=[{value:0,label:r.a.createElement("b",null,"Today")},{value:1,label:"Tomorrow"}],a=2;a<e.props.sliderRange;a++){var n=new Date(Date.now()+864e5*a);t.push({value:a,label:N(n)})}e.setState({sliderMarks:t})},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.setSliderMarks()}},{key:"render",value:function(){return r.a.createElement(g.a,{component:"div",align:"center"},r.a.createElement("h4",null,"Movement predictions (USA only)"),r.a.createElement("p",null,r.a.createElement(J.a,{className:"timeline__slider",onChange:this.props.onTimelineChangeFunc,min:0,max:this.props.sliderRange-1,marks:this.state.sliderMarks})))}}]),a}(r.a.Component),U=a(226),Z=a(227),z=a(137),X=a.n(z),Y=a(136),V=a.n(Y),$=function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(U.a,{position:"static"},r.a.createElement(Z.a,{style:{paddingLeft:0}},"  ",r.a.createElement(g.a,{variant:"h5",style:{flexGrow:1}},r.a.createElement("div",{style:{width:400,textAlign:"center"}},r.a.createElement("img",{src:V.a,style:{height:"1.2em",paddingTop:"0.2em",imageRendering:"crisp-edges"},draggable:!1,alt:"Logo"}))),r.a.createElement(v.a,{startIcon:r.a.createElement(X.a,null),variant:"contained",color:"primary",disableElevation:!0,disabled:this.props.refreshPredictionsDisabled,onClick:this.props.refreshTumbleweedDataFunc},"Reset Predictions")))}}]),a}(r.a.Component),ee=a(145),te=a(229),ae=a(138),ne=a.n(ae),re=(a(192),function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(ee.a,{className:"notification "+this.props.severity,elevation:3},r.a.createElement(h.a,{className:"container",maxWidth:"xs"},r.a.createElement(g.a,{component:"div"},r.a.createElement("h4",null,this.props.title),r.a.createElement("p",null,this.props.body)),r.a.createElement(te.a,{className:"closeIcon",onClick:function(){return e.props.closeFunc(e.props._id)}},r.a.createElement(ne.a,null))))}}]),a}(r.a.Component)),le=a(238),ie=a(230),oe=a(231),ce=a(232),ue=(a(193),function(e){Object(p.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={day:0,sliderMarks:[],sliderRange:8,tumbleweedData:[],selectedTumbleweedData:{tumbleweedIndex:-1,predictionIndex:-1},refreshPredictionsDisabled:!1,refreshTumbleweedDataSnackbarIsOpen:!1,removeTumbleweedDialogIsOpen:!1,notifications:[],deleteTumbleweedFlag:0},e.refreshTumbleweedData=function(){e.setState({refreshPredictionsDisabled:!0,refreshTumbleweedDataSnackbarIsOpen:!1});var t=new FormData;t.append("forced","true"),f()({method:"post",url:"https://tumbleweed-go-284013.ue.r.appspot.com/tumbleweed/update",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.setState({refreshPredictionsDisabled:!1,refreshTumbleweedDataSnackbarIsOpen:!0}),e.addNotification(null,"Tumbleweed movement predictions reset! Refresh the page to see the updates.","info",0)})).catch((function(e){console.log("big rip "+e)}))},e.closeRefreshTumbleweedDataSnackbar=function(){e.setState({refreshTumbleweedDataSnackbarIsOpen:!1})},e.getData=function(e){f.a.get("https://tumbleweed-go-284013.ue.r.appspot.com/tumbleweed/get").then((function(t){t.status&&200===t.status?e(t.data.result):console.log("rip "+t.status)})).catch((function(e){console.log("big rip "+e)}))},e.getSelectedTumbleweedData=function(){var t=e.state.selectedTumbleweedData.tumbleweedIndex;return-1===t?null:e.state.tumbleweedData[t]},e.onTimelineChange=function(t,a){e.setState({day:a}),e.updateSelectedTumbleweedData(e.state.selectedTumbleweedData.tumbleweedIndex,a-1)},e.updateSelectedTumbleweedData=function(t,a){e.setState({selectedTumbleweedData:{tumbleweedIndex:t,predictionIndex:a}})},e.openDialog=function(){return e.setState({removeTumbleweedDialogIsOpen:!0})},e.handleDialogClose=function(t){e.setState({removeTumbleweedDialogIsOpen:!1}),t&&e.removeTumbleweed((function(t){200===t?(e.addNotification("Success","Tumbleweed has been removed.","success",5e3),e.setState({deleteTumbleweedFlag:Date.now()})):e.addNotification("Error","There was an error removing the tumbleweed.","error",5e3)}))},e.removeTumbleweed=function(t){var a=e.state.selectedTumbleweedData.tumbleweedIndex,n=new FormData;n.append("id",e.state.tumbleweedData[a]._id),f()({method:"post",url:"https://tumbleweed-go-284013.ue.r.appspot.com/tumbleweed/delete",data:n,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){e.status&&200===e.status||console.log("rip "+e.status),t(e.status)})).catch((function(e){console.log("big rip "+e),t(500)}))},e.initData=function(){e.getData((function(t){e.setState({tumbleweedData:t})}))},e.addNotification=function(t,a,n,r){var l="".concat(Date.now(),"_").concat(Math.random()),i={id:l,title:t,body:a,severity:n};0!==r&&setTimeout((function(){e.removeNotification(l)}),r),e.setState((function(e){return{notifications:[].concat(Object(s.a)(e.notifications),[i])}}))},e.removeNotification=function(t){e.setState((function(e){return{notifications:e.notifications.filter((function(e){return e.id!==t}))}}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"appContainer"},r.a.createElement("div",{className:"map__wrapper"},r.a.createElement(A,{data:this.state.tumbleweedData,day:this.state.day,sliderRange:this.state.sliderRange,selectedTumbleweedIndex:this.state.selectedTumbleweedData.tumbleweedIndex,deleteTumbleweedFlag:this.state.deleteTumbleweedFlag,updateSelectedTumbleweedDataFunc:this.updateSelectedTumbleweedData})),r.a.createElement(h.a,{maxWidth:!1,className:"info"},r.a.createElement(q,{data:this.getSelectedTumbleweedData(),predictionIndex:this.state.selectedTumbleweedData.predictionIndex,removeTumbleweedFunc:this.openDialog})),r.a.createElement(h.a,{maxWidth:!1,className:"timeline"},r.a.createElement(Q,{sliderRange:this.state.sliderRange,onTimelineChangeFunc:this.onTimelineChange})),r.a.createElement("div",{className:"topBar"},r.a.createElement($,{refreshPredictionsDisabled:this.state.refreshPredictionsDisabled,refreshTumbleweedDataFunc:this.refreshTumbleweedData}))),r.a.createElement(le.a,{maxWidth:"sm",open:this.state.removeTumbleweedDialogIsOpen},r.a.createElement(ie.a,null,"Confirm"),r.a.createElement(oe.a,null,r.a.createElement(g.a,{gutterBottom:!0},"Are you sure you would like to remove this tumbleweed?")),r.a.createElement(ce.a,null,r.a.createElement(v.a,{autoFocus:!0,onClick:function(){return e.handleDialogClose(!1)},color:"primary"},"Cancel"),r.a.createElement(v.a,{onClick:function(){return e.handleDialogClose(!0)},color:"primary"},"Confirm"))),r.a.createElement("div",{id:"notification-container"},this.state.notifications.map((function(t){return r.a.createElement(re,{key:t.id,_id:t.id,title:t.title,body:t.body,severity:t.severity,closeFunc:e.removeNotification})}))))}}]),a}(r.a.Component)),se=(a(194),Object(o.a)({palette:{primary:{main:u.a[500]}}}));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{theme:se},r.a.createElement(ue,null))),document.getElementById("root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.db48a503.chunk.js.map