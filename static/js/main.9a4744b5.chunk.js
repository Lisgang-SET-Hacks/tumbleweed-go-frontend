(this["webpackJsonptumbleweed-go-frontend"]=this["webpackJsonptumbleweed-go-frontend"]||[]).push([[0],{133:function(e,t,a){e.exports=a(163)},138:function(e,t,a){},162:function(e,t,a){},163:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),l=a(75),o=a.n(l),i=(a(138),a(61)),c=a(62),u=a(66),s=a(64),d=a(106),m=a.n(d),p=a(180),w=a(184),b=a(112),f=a(177),h=a(188),g=a(181),y=a(113),v=a(6),T=a(107),L=a(187),E=a(182),_=a(186),D=a(185),S=a(183),I=a(94),x=a(96),O=a(93),k=a(74),R=function(e){var t=e.toDateString().split(" ");return t[0]+" "+t[2]},j=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=e<0?"S":"N",r=t<0?"W":"E";return"".concat(e.toFixed(a),"&#xb0;").concat(n,", ").concat(t.toFixed(a),"&#xb0;").concat(r)},M=(a(156),function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).initWithData=function(e){for(var t=[],a=[],r=0;r<n.props.sliderRange;r++)t.push(n.setTumbleweedLayer(e,r-1)),a.push(n.setTumbleweedTrailLayer(e,r-1));n.setState({tumbleweedLayers:t,currentTumbleweedLayer:t[0],tumbleweedTrailLayers:a,currentTumbleweedTrailLayer:a[0]},(function(){n.initMap()}))},n.setTumbleweedLayer=function(e,t){var a=new I.b({image:new x.a({radius:8,fill:new O.a({color:"#e3af2b"}),stroke:new k.a({color:"#664e13",width:2})})}),n=new I.b({image:new x.a({radius:8,fill:new O.a({color:"#e2cf9e"}),stroke:new k.a({color:"#664e13",width:2})})}),r=e.map((function(e,r){var l,o,i,c=a;if(-1===t)l="tumbleweed_".concat(r),i=e.location._lat,o=e.location._long;else if(0===e.predictedLocations.length)l="tumbleweed_".concat(r),i=e.location._lat,o=e.location._long,c=n;else if(t<e.predictedLocations.length)l="tumbleweed_".concat(r,"_").concat(t),i=e.predictedLocations[t]._lat,o=e.predictedLocations[t]._long;else{var u=e.predictedLocations.length-1;l="tumbleweed_".concat(r,"_").concat(u),i=e.predictedLocations[u]._lat,o=e.predictedLocations[u]._long,c=n}var s=new f.a({geometry:new T.a(Object(v.d)([o,i]))});return s.setId(l),s.setStyle(c),s})),l=new E.a({source:new D.a({features:r})});return l.set("name","tumbleweeds"),l},n.setTumbleweedTrailLayer=function(e,t){var a=new I.b({stroke:new k.a({color:"#664e13",width:4})}),n=[];if(-1!==t)for(var r=function(t){e.forEach((function(e){if(t<e.predictedLocations.length){var r=0===t?e.location._lat:e.predictedLocations[t-1]._lat,l=0===t?e.location._long:e.predictedLocations[t-1]._long,o=e.predictedLocations[t]._lat,i=e.predictedLocations[t]._long,c=new f.a({geometry:new L.a([Object(v.d)([l,r]),Object(v.d)([i,o])])});c.setStyle(a),n.push(c)}}))},l=0;l<=t;l++)r(l);var o=new E.a({source:new D.a({features:n})});return o.set("name","tumbleweedTrails"),o},n.initMap=function(){var e=new _.a({className:"map__bingMaps",source:new S.a({key:"AtMr0RAC0iKdKPPPsGSPqIFCxjk7XpR9rq99IQR5vDBoax8u1KuYvOinwtsiQcFI",imagerySet:"AerialWithLabelsOnDemand"})});n.popupOverlay=new h.a({element:n.popupRef.current,positioning:"bottom-center",stopEvent:!1,offset:[0,-16]}),n.map=new g.a({layers:[e,n.state.currentTumbleweedTrailLayer,n.state.currentTumbleweedLayer],overlays:[n.popupOverlay],target:n.mapRef.current,view:new y.a({center:Object(v.d)([-97,42]),zoom:5,minZoom:5,maxZoom:15})}),n.map.on("click",(function(e){n.deselectTumbleweed(),n.hidePopup(),n.map.forEachFeatureAtPixel(e.pixel,(function(e,t){if("tumbleweeds"===t.get("name"))return n.selectTumbleweed(e),n.showPopup(e),!0}))})),n.map.on("pointermove",(function(e){n.map.getTarget().style.cursor="",n.map.forEachFeatureAtPixel(e.pixel,(function(e,t){if("tumbleweeds"===t.get("name"))return n.map.getTarget().style.cursor="pointer",!0}))}))},n.selectTumbleweed=function(e){var t=String(e.getId()).split("_").splice(1),a=Object(b.a)(t,2),r=a[0],l=a[1];void 0!==l?n.props.updateSelectedTumbleweedDataFunc(r,l):n.props.updateSelectedTumbleweedDataFunc(r,-1)},n.deselectTumbleweed=function(){n.props.updateSelectedTumbleweedDataFunc(-1,-1)},n.showPopup=function(e){var t=e.getGeometry().getCoordinates(),a=Object(v.n)(t,"EPSG:3857","EPSG:4326");n.popupRef.current.innerHTML=j(a[1],a[0],3),n.popupRef.current.style.display="block",n.popupOverlay.setPosition(t)},n.hidePopup=function(){n.popupRef.current.style.display="none"},n.refreshPopup=function(){if(-1!==n.props.selectedTumbleweedIndex){var e=n.state.currentTumbleweedLayer.getSource().getFeatures();n.showPopup(e[n.props.selectedTumbleweedIndex])}},n.showTumbleweedLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.map.removeLayer(n.state.currentTumbleweedTrailLayer),n.map.removeLayer(n.state.currentTumbleweedLayer),n.map.addLayer(n.state.tumbleweedTrailLayers[e]),n.map.addLayer(n.state.tumbleweedLayers[e]),n.setState({currentTumbleweedLayer:n.state.tumbleweedLayers[e],currentTumbleweedTrailLayer:n.state.tumbleweedTrailLayers[e]},(function(){return t()}))},n.state={tumbleweedLayers:[],currentTumbleweedLayer:null,tumbleweedTrailLayers:[],currentTumbleweedTrailLayer:null},n.map=null,n.popupOverlay=null,n.mapRef=r.a.createRef(),n.popupRef=r.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e,t){var a=this;e.data!==this.props.data&&this.initWithData(this.props.data),e.day!==this.props.day&&this.showTumbleweedLayer(this.props.day,(function(){a.refreshPopup()}))}},{key:"render",value:function(){return r.a.createElement("div",{ref:this.mapRef,className:"map"},r.a.createElement("div",{ref:this.popupRef,className:"map__popup",style:{display:"none"}}))}}]),a}(r.a.Component)),P=a(178),F=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).renderInfo=function(){var t=e.props,a=t.data,n=t.predictionIndex;if(!a)return r.a.createElement("p",null,"No tumbleweed selected.");var l=a.location;if(a.predictedLocations.length>0&&-1!==n){var o=Math.min(n,a.predictedLocations.length-1);l=a.predictedLocations[o]}return r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",null,"Current position (est.)"),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:j(l._lat,l._long)}}),r.a.createElement(P.a,null),r.a.createElement("h4",null,"Initial sighting time"),r.a.createElement("p",null,new Date(a.uploadTime).toLocaleDateString(),r.a.createElement("br",null),new Date(a.uploadTime).toLocaleTimeString()),r.a.createElement("h4",null,"Initial sighting position"),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:j(a.uploadLocation._lat,a.uploadLocation._long)}}),r.a.createElement("h4",null,"Initial sighting image"),r.a.createElement("div",{className:"aspect-ratio",style:{paddingBottom:"75%"}},r.a.createElement("div",null,r.a.createElement("img",{src:"https://picsum.photos/400",alt:"Initial sighting"}))))},e}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"Tumbleweed Info"),r.a.createElement(P.a,null),this.renderInfo())}}]),a}(r.a.Component),N=(a(162),function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),o=0;o<n;o++)l[o]=arguments[o];return(e=t.call.apply(t,[this].concat(l))).state={day:0,sliderMarks:[],sliderRange:8,tumbleweedData:[],selectedTumbleweedData:{tumbleweedIndex:-1,predictionIndex:-1}},e.getData=function(e){m.a.get("https://tumbleweed-go-284013.ue.r.appspot.com/tumbleweed/get").then((function(t){t.status&&200===t.status?e(t.data.result):console.log("rip "+t.status)})).catch((function(e){console.log("big rip "+e)}))},e.getSelectedTumbleweedData=function(){var t=e.state.selectedTumbleweedData.tumbleweedIndex;return-1===t?null:e.state.tumbleweedData[t]},e.onTimelineChange=function(t,a){e.setState({day:a}),e.updateSelectedTumbleweedData(e.state.selectedTumbleweedData.tumbleweedIndex,a-1)},e.setSliderMarks=function(){for(var t=[{value:0,label:r.a.createElement("b",null,"Today")},{value:1,label:"Tomorrow"}],a=2;a<e.state.sliderRange;a++){var n=new Date(Date.now()+864e5*a);t.push({value:a,label:R(n)})}e.setState({sliderMarks:t})},e.updateSelectedTumbleweedData=function(t,a){e.setState({selectedTumbleweedData:{tumbleweedIndex:t,predictionIndex:a}})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setSliderMarks(),this.getData((function(t){e.setState({tumbleweedData:t})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"map__wrapper"},r.a.createElement(M,{data:this.state.tumbleweedData,day:this.state.day,sliderRange:this.state.sliderRange,selectedTumbleweedIndex:this.state.selectedTumbleweedData.tumbleweedIndex,updateSelectedTumbleweedDataFunc:this.updateSelectedTumbleweedData})),r.a.createElement(p.a,{className:"info"},r.a.createElement(F,{data:this.getSelectedTumbleweedData(),predictionIndex:this.state.selectedTumbleweedData.predictionIndex})),r.a.createElement("div",{className:"timeline"},r.a.createElement("h4",{style:{marginTop:0}},"Movement predictions (USA only)"),r.a.createElement(w.a,{className:"timeline__slider",onChange:this.onTimelineChange,min:0,max:this.state.sliderRange-1,marks:this.state.sliderMarks})))}}]),a}(r.a.Component));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root"))}},[[133,1,2]]]);
//# sourceMappingURL=main.9a4744b5.chunk.js.map