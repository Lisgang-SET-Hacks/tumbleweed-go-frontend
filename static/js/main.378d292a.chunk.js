(this["webpackJsonptumbleweed-go-frontend"]=this["webpackJsonptumbleweed-go-frontend"]||[]).push([[0],{150:function(e,t,a){e.exports=a(181)},155:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(47),i=a.n(l),o=(a(155),a(52)),c=a(61),s=a(54),u=a(53),d=a(105),m=a.n(d),p=a(210),b=a(215),w=a(211),h=a(127),f=a.n(h),g=a(128),y=a(201),v=a(220),T=a(212),E=a(129),L=a(7),D=a(121),S=a(219),O=a(213),_=a(217),k=a(216),x=a(214),j=a(106),I=a(107),R=a(102),P=a(84),C=function(e){var t=e.toDateString().split(" ");return t[0]+" "+t[2]},M=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=e<0?"S":"N",r=t<0?"W":"E";return"".concat(e.toFixed(a),"&#xb0;").concat(n,", ").concat(t.toFixed(a),"&#xb0;").concat(r)},F=(a(173),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).initWithData=function(e){for(var t=[],a=[],r=0;r<n.props.sliderRange;r++)t.push(n.setTumbleweedLayer(e,r-1)),a.push(n.setTumbleweedTrailLayer(e,r-1));n.setState({tumbleweedLayers:t,currentTumbleweedLayer:t[0],tumbleweedTrailLayers:a,currentTumbleweedTrailLayer:a[0]},(function(){n.initMap()}))},n.setTumbleweedLayer=function(e,t){var a=new j.b({image:new I.a({radius:8,fill:new R.a({color:"#e3af2b"}),stroke:new P.a({color:"#664e13",width:2})})}),n=new j.b({image:new I.a({radius:8,fill:new R.a({color:"#e2cf9e"}),stroke:new P.a({color:"#664e13",width:2})})}),r=e.map((function(e,r){var l,i,o,c=a;if(-1===t)l="tumbleweed_".concat(r),o=e.location._latitude,i=e.location._longitude;else if(0===e.predictedLocations.length)l="tumbleweed_".concat(r),o=e.location._latitude,i=e.location._longitude,c=n;else if(t<e.predictedLocations.length)l="tumbleweed_".concat(r,"_").concat(t),o=e.predictedLocations[t]._latitude,i=e.predictedLocations[t]._longitude;else{var s=e.predictedLocations.length-1;l="tumbleweed_".concat(r,"_").concat(s),o=e.predictedLocations[s]._latitude,i=e.predictedLocations[s]._longitude,c=n}var u=new y.a({geometry:new D.a(Object(L.d)([i,o]))});return u.setId(l),u.setStyle(c),u})),l=new O.a({source:new k.a({features:r})});return l.set("name","tumbleweeds"),l},n.setTumbleweedTrailLayer=function(e,t){var a=new j.b({stroke:new P.a({color:"#664e13",width:4})}),n=[];if(-1!==t)for(var r=function(t){e.forEach((function(e){if(t<e.predictedLocations.length){var r=0===t?e.location._latitude:e.predictedLocations[t-1]._latitude,l=0===t?e.location._longitude:e.predictedLocations[t-1]._longitude,i=e.predictedLocations[t]._latitude,o=e.predictedLocations[t]._longitude,c=new y.a({geometry:new S.a([Object(L.d)([l,r]),Object(L.d)([o,i])])});c.setStyle(a),n.push(c)}}))},l=0;l<=t;l++)r(l);var i=new O.a({source:new k.a({features:n})});return i.set("name","tumbleweedTrails"),i},n.initMap=function(){var e=new _.a({className:"map__bingMaps",source:new x.a({key:"AtMr0RAC0iKdKPPPsGSPqIFCxjk7XpR9rq99IQR5vDBoax8u1KuYvOinwtsiQcFI",imagerySet:"AerialWithLabelsOnDemand"})});n.popupOverlay=new v.a({element:n.popupRef.current,positioning:"bottom-center",stopEvent:!1,offset:[0,-16]}),n.map=new T.a({layers:[e,n.state.currentTumbleweedTrailLayer,n.state.currentTumbleweedLayer],overlays:[n.popupOverlay],target:n.mapRef.current,view:new E.a({center:Object(L.d)([-97,42]),zoom:5,minZoom:5,maxZoom:15})}),n.map.on("click",(function(e){n.deselectTumbleweed(),n.hidePopup(),n.map.forEachFeatureAtPixel(e.pixel,(function(e,t){if("tumbleweeds"===t.get("name"))return n.selectTumbleweed(e),n.showPopup(e),!0}))})),n.map.on("pointermove",(function(e){n.map.getTarget().style.cursor="",n.map.forEachFeatureAtPixel(e.pixel,(function(e,t){if("tumbleweeds"===t.get("name"))return n.map.getTarget().style.cursor="pointer",!0}))}))},n.selectTumbleweed=function(e){var t=String(e.getId()).split("_").splice(1),a=Object(g.a)(t,2),r=a[0],l=a[1];void 0!==l?n.props.updateSelectedTumbleweedDataFunc(r,l):n.props.updateSelectedTumbleweedDataFunc(r,-1)},n.deselectTumbleweed=function(){n.props.updateSelectedTumbleweedDataFunc(-1,-1)},n.showPopup=function(e){var t=e.getGeometry().getCoordinates(),a=Object(L.n)(t,"EPSG:3857","EPSG:4326");n.popupRef.current.innerHTML=M(a[1],a[0],3),n.popupRef.current.style.display="block",n.popupOverlay.setPosition(t)},n.hidePopup=function(){n.popupRef.current.style.display="none"},n.refreshPopup=function(){if(-1!==n.props.selectedTumbleweedIndex){var e=n.state.currentTumbleweedLayer.getSource().getFeatures();n.showPopup(e[n.props.selectedTumbleweedIndex])}},n.showTumbleweedLayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};n.map.removeLayer(n.state.currentTumbleweedTrailLayer),n.map.removeLayer(n.state.currentTumbleweedLayer),n.map.addLayer(n.state.tumbleweedTrailLayers[e]),n.map.addLayer(n.state.tumbleweedLayers[e]),n.setState({currentTumbleweedLayer:n.state.tumbleweedLayers[e],currentTumbleweedTrailLayer:n.state.tumbleweedTrailLayers[e]},(function(){return t()}))},n.state={tumbleweedLayers:[],currentTumbleweedLayer:null,tumbleweedTrailLayers:[],currentTumbleweedTrailLayer:null},n.map=null,n.popupOverlay=null,n.mapRef=r.a.createRef(),n.popupRef=r.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidUpdate",value:function(e,t){var a=this;e.data!==this.props.data&&this.initWithData(this.props.data),e.day!==this.props.day&&this.showTumbleweedLayer(this.props.day,(function(){a.refreshPopup()}))}},{key:"render",value:function(){return r.a.createElement("div",{ref:this.mapRef,className:"map"},r.a.createElement("div",{ref:this.popupRef,className:"map__popup",style:{display:"none"}}))}}]),a}(r.a.Component)),N=a(202),A=a(204),G=a(205),W=a(206),B=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).render=function(){var t=e.props,a=t.data,n=t.predictionIndex;if(!a)return r.a.createElement(N.a,{component:"div",align:"center"},r.a.createElement("p",null,"No tumbleweed selected."));var l=a.location;if(a.predictedLocations.length>0&&-1!==n){var i=Math.min(n,a.predictedLocations.length-1);l=a.predictedLocations[i]}return r.a.createElement(N.a,{component:"div",align:"center"},r.a.createElement("h4",null,"Current position (est.)"),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:M(l._latitude,l._longitude)}}),r.a.createElement(A.a,null),r.a.createElement("h4",null,"Initial sighting time"),r.a.createElement("p",null,new Date(a.uploadTime).toLocaleDateString(),r.a.createElement("br",null),new Date(a.uploadTime).toLocaleTimeString()),r.a.createElement("h4",null,"Initial sighting position"),r.a.createElement("p",{dangerouslySetInnerHTML:{__html:M(a.uploadLocation._latitude,a.uploadLocation._longitude)}}),r.a.createElement("h4",null,"Initial sighting image"),r.a.createElement(G.a,{className:"aspect-ratio",variant:"outlined",style:{paddingBottom:"75%",marginBottom:"1em"}},r.a.createElement("div",null,r.a.createElement(W.a,{onClick:function(){return alert("test")}},r.a.createElement("img",{src:"https://picsum.photos/400",alt:"Initial sighting"})))))},e}return a}(r.a.Component),z=a(218),H=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).state={sliderMarks:[]},e.setSliderMarks=function(){for(var t=[{value:0,label:r.a.createElement("b",null,"Today")},{value:1,label:"Tomorrow"}],a=2;a<e.props.sliderRange;a++){var n=new Date(Date.now()+864e5*a);t.push({value:a,label:C(n)})}e.setState({sliderMarks:t})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.setSliderMarks()}},{key:"render",value:function(){return r.a.createElement(N.a,{component:"div",align:"center"},r.a.createElement("h4",null,"Movement predictions (USA only)"),r.a.createElement("p",null,r.a.createElement(z.a,{className:"timeline__slider",onChange:this.props.onTimelineChangeFunc,min:0,max:this.props.sliderRange-1,marks:this.state.sliderMarks})))}}]),a}(r.a.Component),K=a(207),q=a(208),J=a(209),Q=a(126),U=a.n(Q),Z=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(K.a,{position:"static"},r.a.createElement(q.a,{style:{paddingLeft:0}},"  ",r.a.createElement(N.a,{variant:"h5",style:{flexGrow:1}},r.a.createElement("div",{className:"rowdies",style:{width:400,textAlign:"center"}},"Tumbleweed GO")),r.a.createElement(J.a,{startIcon:r.a.createElement(U.a,null),variant:"contained",color:"primary",disableElevation:!0,disabled:this.props.refreshPredictionsDisabled,onClick:this.props.refreshTumbleweedDataFunc},"Reset Predictions")))}}]),a}(r.a.Component),X=(a(180),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={day:0,sliderMarks:[],sliderRange:8,tumbleweedData:[],selectedTumbleweedData:{tumbleweedIndex:-1,predictionIndex:-1},refreshPredictionsDisabled:!1,refreshTumbleweedDataSnackbarOpen:!1},e.refreshTumbleweedData=function(){e.setState({refreshPredictionsDisabled:!0,refreshTumbleweedDataSnackbarOpen:!1});var t=new FormData;t.append("forced","true"),m()({method:"post",url:"https://tumbleweed-go-284013.ue.r.appspot.com/tumbleweed/update",data:t,headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.setState({refreshPredictionsDisabled:!1,refreshTumbleweedDataSnackbarOpen:!0})})).catch((function(e){console.log("big rip "+e)}))},e.closeRefreshTumbleweedDataSnackbar=function(){e.setState({refreshTumbleweedDataSnackbarOpen:!1})},e.getData=function(e){m.a.get("https://tumbleweed-go-284013.ue.r.appspot.com/tumbleweed/get").then((function(t){t.status&&200===t.status?e(t.data.result):console.log("rip "+t.status)})).catch((function(e){console.log("big rip "+e)}))},e.getSelectedTumbleweedData=function(){var t=e.state.selectedTumbleweedData.tumbleweedIndex;return-1===t?null:e.state.tumbleweedData[t]},e.onTimelineChange=function(t,a){e.setState({day:a}),e.updateSelectedTumbleweedData(e.state.selectedTumbleweedData.tumbleweedIndex,a-1)},e.updateSelectedTumbleweedData=function(t,a){e.setState({selectedTumbleweedData:{tumbleweedIndex:t,predictionIndex:a}})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.getData((function(t){e.setState({tumbleweedData:t})}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"map__wrapper"},r.a.createElement(F,{data:this.state.tumbleweedData,day:this.state.day,sliderRange:this.state.sliderRange,selectedTumbleweedIndex:this.state.selectedTumbleweedData.tumbleweedIndex,updateSelectedTumbleweedDataFunc:this.updateSelectedTumbleweedData})),r.a.createElement(p.a,{maxWidth:!1,className:"info"},r.a.createElement(B,{data:this.getSelectedTumbleweedData(),predictionIndex:this.state.selectedTumbleweedData.predictionIndex})),r.a.createElement(p.a,{maxWidth:!1,className:"timeline"},r.a.createElement(H,{sliderRange:this.state.sliderRange,onTimelineChangeFunc:this.onTimelineChange})),r.a.createElement("div",{className:"topBar"},r.a.createElement(Z,{refreshPredictionsDisabled:this.state.refreshPredictionsDisabled,refreshTumbleweedDataFunc:this.refreshTumbleweedData}))),r.a.createElement(b.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:this.state.refreshTumbleweedDataSnackbarOpen,message:"Tumbleweed movement predictions reset! Refresh the page to see the updates.",action:r.a.createElement(w.a,{size:"small","aria-label":"close",color:"inherit",onClick:this.closeRefreshTumbleweedDataSnackbar},r.a.createElement(f.a,{fontSize:"small"}))}))}}]),a}(r.a.Component));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X,null)),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.378d292a.chunk.js.map